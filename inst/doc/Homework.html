<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24204132" />

<meta name="date" content="2024-12-04" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">SA24204132</h4>
<h4 class="date">2024-12-04</h4>



<div id="hw1" class="section level2">
<h2>HW1</h2>
<div id="answers-3.4" class="section level3">
<h3>Answers 3.4</h3>
<p>This part gives the answer to question 3.4 in page 94. We can easily
inferred that the cumulative distribution function of this distribution
is as followed. As is demonstrated in the formula, the cdf is a
continuously one-one mapping so that the inverse transform method maybe
proper.</p>
<p><span class="math display">\[CDF:F(x) =
1-exp\{-\frac{x^2}{2\sigma^2}\}\]</span></p>
<p><span class="math display">\[Inverse\
transformed:F^{-1}(x)=\sqrt{-2\sigma^2ln(1-x)}\]</span></p>
<p>The algorithm to generate 5000 random numbers is shown in the code
chunk. <code>Sys.time</code> was used to get the system time as the
random seed. Then use <code>runif</code> to create 5000 Uniform(0,1)
variables before transforming them into what we need. The second formula
present that how we will treat them. The parameter <span class="math inline">\(\sigma\)</span> is set as 1 while it can be
changed to whatever you wished. Finally, we can see in the histogram
that the mode of the random numbers we made is 1, very closed to the
theoretical mode <span class="math inline">\(\sigma=1\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">5000</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>r))</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">density =</span> <span class="dv">50</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),<span class="at">xlab =</span> <span class="st">&#39;value&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;count&#39;</span>,<span class="at">main =</span> <span class="st">&#39;Rayleigh distribution&#39;</span>, <span class="at">nclass =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section" class="section level3">
<h3>3.11</h3>
<p><span class="math inline">\(X_1\)</span> has the distribution of
Normal(0,1), <span class="math inline">\(X_2\)</span> has the
distribution of Normal(3,1). <span class="math inline">\(\Phi_i(x),i=1,2\)</span> is the respective
cumulative distribution function of two normal variables. After that we
build a U(0, 1) variable to apply in a conditional acceptance statement
<code>as.integer(u&gt;p1)</code> for simulating the mixture distribution
of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. If u is bigger(or smaller) than p1,
then the result will be 1(or 0), so the number turn to be a N(0,1)(or
N(3,1)) variable.</p>
<p><span class="math display">\[X_1 \sim N(0,1),\quad X_2 \sim
N(3,1)\]</span></p>
<p><span class="math display">\[S \sim
F(x)=p_1*\Phi_1(x)+(1-p_1)\Phi_2(x)\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.75</span>,<span class="fl">0.5</span>,<span class="fl">0.25</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="dv">4</span>) {</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5000</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5000</span>,<span class="at">mean =</span> <span class="dv">3</span>,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">5000</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(u <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">-</span>p[i])</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  y <span class="ot">&lt;-</span> k<span class="sc">*</span>x1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k)<span class="sc">*</span>x2</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="fu">hist</span>(y,<span class="at">density =</span> <span class="dv">50</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">6</span>),<span class="at">xlab =</span> <span class="st">&#39;value&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;count&#39;</span>,<span class="at">main =</span> <span class="st">&#39;Mixture Normal&#39;</span>, <span class="at">nclass =</span> <span class="dv">100</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see in the plots, the histogram with p equal to 0.75 does
not show an apparent signature to be bimodal. But when p turns to be
0.5, it seems to have two modes in the distribution.</p>
</div>
<div id="section-1" class="section level3">
<h3>3.20</h3>
<p>In this question, I use a <code>for</code> iteration to create a
vector filled with a compound Poisson(<span class="math inline">\(\lambda\)</span>)-Gamma process required. The
final output contains both the theoretical values and the simulated
values of x(10) process. On conclusion, they are quite similar to each
other with a sample size of 5000.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>; lamda <span class="ot">&lt;-</span> <span class="dv">1</span>; a <span class="ot">&lt;-</span> <span class="dv">1</span>; r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5000</span>) </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>{</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,t<span class="sc">*</span>lamda)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) </span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  {</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y <span class="sc">+</span> <span class="fu">rgamma</span>(<span class="dv">1</span>,a,r)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  }</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>}</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>x_miu <span class="ot">&lt;-</span> t <span class="sc">*</span> lamda <span class="sc">*</span> a <span class="sc">/</span> r</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>x_miu</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>x_bar</span></code></pre></div>
<pre><code>## [1] 10.01129</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>x_sigmasquare <span class="ot">&lt;-</span> t <span class="sc">*</span> lamda <span class="sc">*</span> (a<span class="sc">/</span>r<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> a<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>r<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>x_sigmasquare</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>x_ssquare <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>x_ssquare</span></code></pre></div>
<pre><code>## [1] 20.30371</code></pre>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<div id="exercise" class="section level3">
<h3>Exercise</h3>
<p>The cumulative distribution function of X with <span class="math inline">\(Beta(a,b)\)</span> is presented below.</p>
<p><span class="math display">\[F(x)=\int_{0}^{x}t^{a-1}(1-t)^{b-1}dt
\quad x\in(0,1)\]</span></p>
<p>In this part, I use the simple Monte Carlo method to compute the
possible value of the cdf with some giving parameters.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Write a function to compute the Monte Carlo estimate of cdf</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>mc_cdfbeta <span class="ot">&lt;-</span> <span class="cf">function</span>(x,a,b){</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> x<span class="sc">*</span><span class="fu">runif</span>(n)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  y <span class="ot">&lt;-</span> (<span class="fu">gamma</span>(a<span class="sc">+</span>b)<span class="sc">/</span>(<span class="fu">gamma</span>(a)<span class="sc">*</span><span class="fu">gamma</span>(b)))<span class="sc">*</span>u<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">*</span>x</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  estimate <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(estimate,<span class="dv">5</span>))</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>}</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co"># Compute the result of giving parameter x using the function</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m))</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>{</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  c1[i] <span class="ot">&lt;-</span> <span class="fu">mc_cdfbeta</span>(m[i],<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  c2[i] <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(m[i],<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>}</span></code></pre></div>
<p>The results are shown below the code chunk. c1 is the simulated
value, while c2 is the theoretic value computed by R through
<code>pbeta(x,a,b)</code>. We can see that the two values with each
given parameter are so closed.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>c1</span></code></pre></div>
<pre><code>## [1] 0.00847 0.05737 0.16167 0.31502 0.49679 0.67924 0.83449 0.94172 0.99414</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>c2</span></code></pre></div>
<pre><code>## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
</div>
<div id="section-2" class="section level3">
<h3>5.9</h3>
<p><span class="math display">\[CDF:F(x) =
1-exp\{-\frac{x^2}{2\sigma^2}\}\]</span></p>
<p><span class="math display">\[Inverse\
transformed:F^{-1}(x)=\sqrt{-2\sigma^2ln(1-x)}\]</span></p>
<p>We use the inverse method to create i.i.d variables in Rayleigh
distribution with the sample size of n. In the function, 5000 <span class="math inline">\(U(0,1)\)</span> numbers <span class="math inline">\(u_1\)</span> are created to generate Rayleigh
distribution random numbers <span class="math inline">\(X_1\)</span>.
Variable <span class="math inline">\(u_1^{anti}=1-u_1\)</span> are made
as a preparation for the antithetic variable <span class="math inline">\(X_1^{anti}\)</span>. In the function, another 5000
Rayleigh random numbers are created to show the performance of common
method. Eventually, the function will return a ratio to display to what
extent the antithetic method will reduce the variance of the
estimate.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>antirayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma){</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  </span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="co"># Antithetic variables method</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>u1</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u1))</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  x1_anti <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u2))</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  antix <span class="ot">&lt;-</span> (x1<span class="sc">+</span>x1_anti)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">var</span>(antix)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  </span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>  <span class="co"># Independent variables method</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u3))</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  indx <span class="ot">&lt;-</span> (x1<span class="sc">+</span>x2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">var</span>(indx)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  </span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">-</span>s1<span class="sc">/</span>s2)</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Finally, we can see that the variance of antithetic variables can
extremely reduce the variance.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">antirayleigh</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.9440937</code></pre>
</div>
<div id="section-3" class="section level3">
<h3>5.13</h3>
<p>The function of the calculus to be estimated can be printed as <span class="math inline">\(g(x)\)</span>. The two ‘close’ pdf <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> can be like the ones shown below.
They are both supported on <span class="math inline">\((1,+\infty)\)</span> and easy to compute.</p>
<p><span class="math display">\[g(x)=
\begin{cases}
\frac{x^2}{\sqrt{2\pi}}exp(-\frac{x^2}{2})&amp; \text{x&gt;1}\\
0&amp; \text{x&lt;=0}
\end{cases}\]</span></p>
<p><span class="math display">\[X_1\sim Ga(3,\frac{1}{2}) \quad
f_1(x)=\frac{x^2}{16}exp(-\frac{x}{2}) \quad
x\in(0,+\infty)\]</span></p>
<p><span class="math display">\[X_2\sim N(0,1) \quad
f_2(x)=\frac{1}{\sqrt{2\pi}}exp(-\frac{x^2}{2}) \quad
x\in(-\infty,+\infty)\]</span></p>
<p>Use <code>rgamma</code> and <code>rnorm</code> to create 50000 random
numbers of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> respectively. Then compute the value
of the definite integral through importance sampling method.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">50000</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50000</span>,<span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>g_x1 <span class="ot">&lt;-</span> ((<span class="dv">16</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))<span class="sc">*</span><span class="fu">exp</span>((x1<span class="sc">-</span>x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span>(x1<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>g_x2 <span class="ot">&lt;-</span> x2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(x2<span class="sc">&gt;</span><span class="dv">1</span>)</span></code></pre></div>
<p>The result shows that both two estimates are closed to the
theoretical value. It seems the value under <span class="math inline">\(f_2\)</span> has a commonly smaller variance
compare with the one under <span class="math inline">\(f_1\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">mean</span>(g_x1)</span></code></pre></div>
<pre><code>## [1] 0.4076038</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">mean</span>(g_x2)</span></code></pre></div>
<pre><code>## [1] 0.4061758</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">var</span>(g_x1)</span></code></pre></div>
<pre><code>## [1] 1.225159</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">var</span>(g_x2)</span></code></pre></div>
<pre><code>## [1] 1.311461</code></pre>
</div>
<div id="monte-carlo-experiment" class="section level3">
<h3>Monte Carlo experiment</h3>
<p>Two sorting algorithms are written in this part including a fast
sorting algorithm and a bubble sorting algorithm. Theoretically, they
will acquire a time complexity of <span class="math inline">\(O(nlog(n))\)</span> and <span class="math inline">\(O(n^2)\)</span>. So here I make two regressions of
theoretical computing time to the practical computing time for the two
different algorithms. There scatter plots with the regression line are
also presented to visualize the result.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>quicksort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">&lt;=</span><span class="dv">1</span>)<span class="fu">return</span>(x)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  loc <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size =</span> <span class="dv">1</span>,<span class="at">replace =</span> F)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  low <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  high <span class="ot">&lt;-</span> n</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  <span class="cf">while</span>(low <span class="sc">!=</span> high){</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>    <span class="cf">if</span>(loc <span class="sc">==</span> low){</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>      <span class="cf">if</span>(x[high] <span class="sc">&lt;</span> x[loc]){</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>        tmp <span class="ot">&lt;-</span> x[high]</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>        x[high] <span class="ot">&lt;-</span> x[loc]</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>        x[loc] <span class="ot">&lt;-</span> tmp</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>        low <span class="ot">=</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>        loc <span class="ot">=</span> high</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>        high <span class="ot">=</span> high <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>      }</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>      <span class="cf">if</span>(x[low] <span class="sc">&gt;</span> x[loc]){</span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>        tmp <span class="ot">&lt;-</span> x[low]</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>        x[low] <span class="ot">&lt;-</span> x[loc]</span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>        x[loc] <span class="ot">&lt;-</span> tmp</span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>        high <span class="ot">=</span> high <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a>        loc <span class="ot">=</span> low</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a>        low <span class="ot">=</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a>      }</span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a>    }</span>
<span id="cb28-31"><a href="#cb28-31" tabindex="-1"></a>  }</span>
<span id="cb28-32"><a href="#cb28-32" tabindex="-1"></a>  L <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb28-33"><a href="#cb28-33" tabindex="-1"></a>  R <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb28-34"><a href="#cb28-34" tabindex="-1"></a>  <span class="cf">if</span>(low<span class="sc">&gt;</span><span class="dv">1</span>) L <span class="ot">=</span> x[<span class="dv">1</span><span class="sc">:</span>(low<span class="dv">-1</span>)]</span>
<span id="cb28-35"><a href="#cb28-35" tabindex="-1"></a>  <span class="cf">if</span>(low<span class="sc">&lt;</span><span class="fu">length</span>(x)) R <span class="ot">=</span> x[(low<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb28-36"><a href="#cb28-36" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quicksort</span>(L),x[low],<span class="fu">quicksort</span>(R)))</span>
<span id="cb28-37"><a href="#cb28-37" tabindex="-1"></a>}</span>
<span id="cb28-38"><a href="#cb28-38" tabindex="-1"></a>bubblesort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb28-39"><a href="#cb28-39" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb28-40"><a href="#cb28-40" tabindex="-1"></a>  <span class="cf">if</span>(n<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb28-41"><a href="#cb28-41" tabindex="-1"></a>  {</span>
<span id="cb28-42"><a href="#cb28-42" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb28-43"><a href="#cb28-43" tabindex="-1"></a>  }</span>
<span id="cb28-44"><a href="#cb28-44" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>))</span>
<span id="cb28-45"><a href="#cb28-45" tabindex="-1"></a>  {</span>
<span id="cb28-46"><a href="#cb28-46" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">-</span>i))</span>
<span id="cb28-47"><a href="#cb28-47" tabindex="-1"></a>    {</span>
<span id="cb28-48"><a href="#cb28-48" tabindex="-1"></a>      <span class="cf">if</span>(x[j]<span class="sc">&gt;</span>x[j<span class="sc">+</span><span class="dv">1</span>])</span>
<span id="cb28-49"><a href="#cb28-49" tabindex="-1"></a>      {</span>
<span id="cb28-50"><a href="#cb28-50" tabindex="-1"></a>        temp <span class="ot">&lt;-</span> x[j]</span>
<span id="cb28-51"><a href="#cb28-51" tabindex="-1"></a>        x[j] <span class="ot">&lt;-</span> x[j<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb28-52"><a href="#cb28-52" tabindex="-1"></a>        x[j<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> temp</span>
<span id="cb28-53"><a href="#cb28-53" tabindex="-1"></a>      }</span>
<span id="cb28-54"><a href="#cb28-54" tabindex="-1"></a>    }</span>
<span id="cb28-55"><a href="#cb28-55" tabindex="-1"></a>  }</span>
<span id="cb28-56"><a href="#cb28-56" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb28-57"><a href="#cb28-57" tabindex="-1"></a>}</span>
<span id="cb28-58"><a href="#cb28-58" tabindex="-1"></a>fastersorting <span class="ot">&lt;-</span> <span class="cf">function</span>(arr){</span>
<span id="cb28-59"><a href="#cb28-59" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb28-60"><a href="#cb28-60" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(arr)</span>
<span id="cb28-61"><a href="#cb28-61" tabindex="-1"></a>  <span class="cf">if</span> (n<span class="sc">&lt;=</span><span class="dv">1</span>) </span>
<span id="cb28-62"><a href="#cb28-62" tabindex="-1"></a>  {</span>
<span id="cb28-63"><a href="#cb28-63" tabindex="-1"></a>    <span class="fu">return</span>(arr)</span>
<span id="cb28-64"><a href="#cb28-64" tabindex="-1"></a>  }</span>
<span id="cb28-65"><a href="#cb28-65" tabindex="-1"></a>  loc <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">size =</span> <span class="dv">1</span>,<span class="at">replace =</span> F)</span>
<span id="cb28-66"><a href="#cb28-66" tabindex="-1"></a>  pivot <span class="ot">&lt;-</span> arr[loc]</span>
<span id="cb28-67"><a href="#cb28-67" tabindex="-1"></a>  high <span class="ot">&lt;-</span> n</span>
<span id="cb28-68"><a href="#cb28-68" tabindex="-1"></a>  low <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-69"><a href="#cb28-69" tabindex="-1"></a>  </span>
<span id="cb28-70"><a href="#cb28-70" tabindex="-1"></a>  <span class="co">#左指针向右移动直到出现第一个与pivot的错排停下</span></span>
<span id="cb28-71"><a href="#cb28-71" tabindex="-1"></a>  <span class="cf">while</span>(arr[low]<span class="sc">&lt;</span>pivot)</span>
<span id="cb28-72"><a href="#cb28-72" tabindex="-1"></a>  {</span>
<span id="cb28-73"><a href="#cb28-73" tabindex="-1"></a>    low <span class="ot">&lt;-</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-74"><a href="#cb28-74" tabindex="-1"></a>  }</span>
<span id="cb28-75"><a href="#cb28-75" tabindex="-1"></a>  </span>
<span id="cb28-76"><a href="#cb28-76" tabindex="-1"></a>  <span class="co">#左边指针第一次停下移动，且此时指向一个比pivot大的值</span></span>
<span id="cb28-77"><a href="#cb28-77" tabindex="-1"></a>  <span class="cf">if</span>(low<span class="sc">!=</span>loc)</span>
<span id="cb28-78"><a href="#cb28-78" tabindex="-1"></a>  {</span>
<span id="cb28-79"><a href="#cb28-79" tabindex="-1"></a>    arr[loc] <span class="ot">&lt;-</span> arr[low]</span>
<span id="cb28-80"><a href="#cb28-80" tabindex="-1"></a>    <span class="cf">while</span>(high<span class="sc">&gt;</span>low)</span>
<span id="cb28-81"><a href="#cb28-81" tabindex="-1"></a>    {</span>
<span id="cb28-82"><a href="#cb28-82" tabindex="-1"></a>      <span class="cf">while</span>(arr[high]<span class="sc">&gt;=</span>pivot <span class="sc">&amp;</span> high<span class="sc">&gt;</span>low)</span>
<span id="cb28-83"><a href="#cb28-83" tabindex="-1"></a>      {</span>
<span id="cb28-84"><a href="#cb28-84" tabindex="-1"></a>        high <span class="ot">&lt;-</span> high<span class="dv">-1</span></span>
<span id="cb28-85"><a href="#cb28-85" tabindex="-1"></a>      }</span>
<span id="cb28-86"><a href="#cb28-86" tabindex="-1"></a>      arr[low] <span class="ot">&lt;-</span> arr[high]</span>
<span id="cb28-87"><a href="#cb28-87" tabindex="-1"></a>      <span class="cf">while</span>(arr[low]<span class="sc">&lt;=</span>pivot <span class="sc">&amp;</span> high<span class="sc">&gt;</span>low)</span>
<span id="cb28-88"><a href="#cb28-88" tabindex="-1"></a>      {</span>
<span id="cb28-89"><a href="#cb28-89" tabindex="-1"></a>        low <span class="ot">&lt;-</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-90"><a href="#cb28-90" tabindex="-1"></a>      }</span>
<span id="cb28-91"><a href="#cb28-91" tabindex="-1"></a>      arr[high] <span class="ot">&lt;-</span> arr[low]</span>
<span id="cb28-92"><a href="#cb28-92" tabindex="-1"></a>    }</span>
<span id="cb28-93"><a href="#cb28-93" tabindex="-1"></a>    arr[low] <span class="ot">&lt;-</span> pivot</span>
<span id="cb28-94"><a href="#cb28-94" tabindex="-1"></a>  }</span>
<span id="cb28-95"><a href="#cb28-95" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb28-96"><a href="#cb28-96" tabindex="-1"></a>  {</span>
<span id="cb28-97"><a href="#cb28-97" tabindex="-1"></a>    <span class="cf">if</span>(loc<span class="sc">!=</span>high)</span>
<span id="cb28-98"><a href="#cb28-98" tabindex="-1"></a>    {</span>
<span id="cb28-99"><a href="#cb28-99" tabindex="-1"></a>      <span class="cf">while</span>(high<span class="sc">&gt;</span>low)</span>
<span id="cb28-100"><a href="#cb28-100" tabindex="-1"></a>      {</span>
<span id="cb28-101"><a href="#cb28-101" tabindex="-1"></a>        <span class="cf">while</span>(arr[high]<span class="sc">&gt;=</span>pivot <span class="sc">&amp;</span> high<span class="sc">&gt;</span>low)</span>
<span id="cb28-102"><a href="#cb28-102" tabindex="-1"></a>        {</span>
<span id="cb28-103"><a href="#cb28-103" tabindex="-1"></a>          high <span class="ot">&lt;-</span> high<span class="dv">-1</span></span>
<span id="cb28-104"><a href="#cb28-104" tabindex="-1"></a>        }</span>
<span id="cb28-105"><a href="#cb28-105" tabindex="-1"></a>        arr[low] <span class="ot">&lt;-</span> arr[high]</span>
<span id="cb28-106"><a href="#cb28-106" tabindex="-1"></a>        <span class="cf">while</span>(arr[low]<span class="sc">&lt;=</span>pivot <span class="sc">&amp;</span> high<span class="sc">&gt;</span>low)</span>
<span id="cb28-107"><a href="#cb28-107" tabindex="-1"></a>        {</span>
<span id="cb28-108"><a href="#cb28-108" tabindex="-1"></a>          low <span class="ot">&lt;-</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-109"><a href="#cb28-109" tabindex="-1"></a>        }</span>
<span id="cb28-110"><a href="#cb28-110" tabindex="-1"></a>        arr[high] <span class="ot">&lt;-</span> arr[low]</span>
<span id="cb28-111"><a href="#cb28-111" tabindex="-1"></a>      }</span>
<span id="cb28-112"><a href="#cb28-112" tabindex="-1"></a>      arr[low] <span class="ot">&lt;-</span> pivot</span>
<span id="cb28-113"><a href="#cb28-113" tabindex="-1"></a>    }</span>
<span id="cb28-114"><a href="#cb28-114" tabindex="-1"></a>  }</span>
<span id="cb28-115"><a href="#cb28-115" tabindex="-1"></a>  </span>
<span id="cb28-116"><a href="#cb28-116" tabindex="-1"></a>  L <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb28-117"><a href="#cb28-117" tabindex="-1"></a>  R <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb28-118"><a href="#cb28-118" tabindex="-1"></a>  <span class="cf">if</span>(low<span class="sc">&gt;</span><span class="dv">1</span>) L <span class="ot">=</span> arr[<span class="dv">1</span><span class="sc">:</span>(low<span class="dv">-1</span>)]</span>
<span id="cb28-119"><a href="#cb28-119" tabindex="-1"></a>  <span class="cf">if</span>(low<span class="sc">&lt;</span>n) R <span class="ot">=</span> arr[(low<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb28-120"><a href="#cb28-120" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">fastersorting</span>(L),arr[low],<span class="fu">fastersorting</span>(R)))</span>
<span id="cb28-121"><a href="#cb28-121" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) </span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>{</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  m <span class="ot">&lt;-</span> i<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  t1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  t2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>  {</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">size =</span> m,<span class="at">replace =</span> F)</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>    sta1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>    <span class="fu">fastersorting</span>(a)</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>    end1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>    t1[j] <span class="ot">&lt;-</span> end1<span class="sc">-</span>sta1</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>    sta2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>    <span class="fu">bubblesort</span>(a)</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>    end2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>    t2[j] <span class="ot">&lt;-</span> end2<span class="sc">-</span>sta2</span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>  }</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>  x1[i] <span class="ot">&lt;-</span> m<span class="sc">*</span><span class="fu">log2</span>(m)</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>  y1[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(t1)</span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>  x2[i] <span class="ot">&lt;-</span> m<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a>  y2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(t2)</span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a>  </span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a>}</span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a>relation1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y1<span class="sc">~</span>x1)</span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a>relation2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y2<span class="sc">~</span>x2)</span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(relation1))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x1)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -2.127e-04 -6.531e-05 -1.340e-05  5.761e-05  3.803e-04 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.788e-04  2.842e-05   9.809 4.74e-13 ***
## x1          8.792e-07  1.139e-08  77.166  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0001077 on 48 degrees of freedom
## Multiple R-squared:  0.992,  Adjusted R-squared:  0.9918 
## F-statistic:  5955 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(relation2))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y2 ~ x2)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -1.161e-04 -2.110e-05  3.084e-06  1.868e-05  1.413e-04 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.476e-05  1.123e-05   2.205   0.0323 *  
## x2          2.846e-08  9.799e-11 290.449   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.26e-05 on 48 degrees of freedom
## Multiple R-squared:  0.9994, Adjusted R-squared:  0.9994 
## F-statistic: 8.436e+04 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">plot</span>(x1,y1)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y1<span class="sc">~</span>x1))</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="fu">plot</span>(x2,y2)</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y2<span class="sc">~</span>x2))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmZmZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb2//b/9vb////tmb/25D//7b//9v///8QXYMJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJEUlEQVR4nO2d25bbNgxFmTaXNtPWces2nrH+/ztr3WzKonwAiiCRzNkPs1J7KiJbEAjSkhM68pTQOgDvUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQGFBYZOy49SLp7SgjZebCdp42Zmg0PkSFBR/7xqC+ng8CVLFQ0E5R8gnHVDDIp180VuRri/o+WQVNDWxgqDQ+cogd9N80z4o/Vp1QU9Tus/oVh17YtgwTPLOMqjZkiYlqFOdsPdXg8YrjILmsVOvOZvFhmvMkSBdPO9yFvOVQYMdR4KC+WL1HMKHb5qAnE3zw4tGgo4hfH39/Xv39vKX9HDj5eUpg3Rthyrw48fv3XHIntP1T6LDBY+CrDrpIW9ev/SCzr/8IzpcmCZ5P4KC4Wr+7eXr9efl306eQbdwHAkaSpDNJXaa82ZUJTjcLX/cbHeYCupO4/R1Dhs1OlWDOt01X5atGuSnUZxrtBtBQbl4riCo85RB8yRvJOhyGK/sjTksXYOmHaEmrAWZbnecwlSbz0FapOdS6UTQeKqsFquXw02LappXrX3KspHRRjUoWmAIG8Vw21pwI8hyqaHPoHDbLHMiSH/ClDVoSiFpDbqnsxNBtwnVaBZ7exmL7kb+JDJo3guyFPT6eatvLXDCbPug+zLDQtB8up40Hs4FRZuJJhk0XemKDLoVaB+NYrRgtLnE3l76i10nyLIGbTaKG6vnqCezqkH9/t1a0FY890+gXEzz8WaiWZG+njRxBkU9ootGMUR7d3az2OvnX70Iyskge0F9YZQKypg0LBvFeKfMRaOYc8IMG8X4CjMSpJtVbwsxTTyGfVCU0EaClNsv8Treh6DuNomZCFLXxIqCToJZbLHZarPUUG6/RB+v+Mig6BrzkUH3ztGJIONZTDerLnbKHAhaTGJmazHVrNqZX2KaaTUsblRq3wct5ozai9V0QPHerwNBi1vvHCw1lstpraDT9X8dCszWfDlFpMto4yKtmlbDrhrU3wTw9vKpey5Itf2SecmPvyjYvOx0GbSY4zUBRSNdDtdRngjKyOjsS+xyeJbJtzDE02p4SCD1mm8c6Pjx+xNBukYxLO7qUF9il8MnwW9Lp9VQJIOuHD+VyqBljc6oQdv3/Gi4T6IPJUBbgyYt1zPytAaJG8UQL+U18dg0irOg/HHmv/vza1/eKE43vXgRtL6rrHUfdLtr4fEN8RHKBrScMsqPI+WxBiXekB7hmq2SMi083GON1gvSxSPYfsnM6OgX++Z1o9aJiS+xbkeRLh3PkEFZGb38xdyYVp1rCGG3oB3xrId9vEMguwadnvbS4sM9dB35NahQPKvbpvIEnYcV4tDh7wvosY/OFATjkS9WH2/dzBDU9xRjJFt9u/xwj+crR5AgHvn2S35GR7PY5kNgCiJBO/sgQTzbS41kTdw5zZchTD8fzpdNH6RYrK5ujm4qaF7KG44zIF+sTpe8H0HLdY/BOCPixWpi+0w6hlEGhSqCdNsveZPGj1yDBETxZJ4wwwyyHEeKV0GrGt1Y0Pq7BFoKStVoCooOFxLxtBaUXxNtMmh1yTevQZ0jQY/79RbjSBnjedhuvb0hPkLpgNZ+2gpKnLHGNWh1whoL2jGrWgjqulUb1FJQqrFvKWh5H47ROCiMeLtj36RhIChREptn0OqMNRbkqkinanTjGpR4LL2doPVWhyoeixq0Xqq2FrQqiRR0H3bnJV9c0OozVZNxpMyzamtB0bSansRa16D8jC6fQd26bS0/jpTQLW/4j98QH6FsQOma2E5QehJrLGjtx0iQ4KPnvSestKCNK8xGkOSj53QCtRWUOqqFINEHh3UF4ZROzxk2giQfPW+UICNBgpROX/G1MygsSAVkIkiS0um+1awGwY+ed9dETeDSlN51xlTgj579ZVCyLWvXB22UILMahFM67aexoMQb4iOoxhPcTbE3IBXCWbWeIMHhEvvRBuOMyGbVVNfRsFFMx9OsUaycQbKU3j+ODHmjuCMeg0YxaahpBu2Jx6BRrHaJyWbVioJkKZ2s0U0bRVcZ1KXboLZ9UOoN8RE0wwlTevc45agsSLr22T2OFOn2y454yvdB6UPWbRTDgl3xFO+kN47YcJrfF0/5RrHEODKEs+q+eMo0is/TWT2OkIzv2NfHY7AflEYxjhhpo7gnnsKN4ni8+4/4jwbAWfU+flj/l4jCGVRZEKaqIEFKv3NBmpSuK2jzS3QqCxIe7/1mkCKgdy4Ip/Q7F4QDqiIIdvbvXBDeAvYnqCaSvmw3hRerVZF09rsps1htg7sMqhKQBkFnv5vSi9W64M5+Nz90BtWg9GL1p6P0YvWn40fug6pAQQAKAlAQgIIARQWdQyjxXYPFKBFPSUHnazRnR4aKxFNQ0NhoHwt86XIZysRTUND4j1U+/YdCqlImnpKCvvTZ7GQZ25WKp6Cg8XL3U4TKxENBAF5iABZpAKd5ABtFQNGlxsnZUqNEPFysAigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEAY0Gvv3m5GaabHijVPqZkK+jtxc3dQr2fD9+6U1DeDmMq6Ozl8d+BvBuqLAT1Mby9fO0fu3NxQ94cz4D2hiELQf2tXdMzmy4ERfF03dFBBl21/P3Ht+lPDgRF8egfJrWpQce5FPoQFMWjrdFGgs63p399CJrjyXgY2UTQ5fDnJMaHoDmeU8bD2iaCTh//mx6x9yFoiuf2VLsGC0H9NzRMZlwImuJ5/ZzzsL+FoON1Sr0chmroQtAUz2l85t9BH/RTQUEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAf4H1RtUgiwCpUoAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<div id="section-4" class="section level3">
<h3>6.6</h3>
<p>I set a size of 10000 experiment to generate skewness sample from
standard normal distribution. Then we can get 0.025, 0.05, 0.95, 0.975
quantiles respectively. Then we can compare them with the theoretical
value under the large sample hypothesis.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>q.ske <span class="ot">&lt;-</span> q.lsa <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  skex <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>    skex[j] <span class="ot">&lt;-</span> <span class="fu">skewness</span>(x)</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  }</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>  q.ske[i] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skex,<span class="at">probs =</span> p[i])</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  q.lsa[i] <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(p[i], <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>}</span></code></pre></div>
<p><code>q.ske</code> is for the empirical value while
<code>q.lsa</code> is the large sample value.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.025 0.050 0.950 0.975</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">print</span>(q.ske)</span></code></pre></div>
<pre><code>## [1] -0.1520992 -0.1268254  0.1293655  0.1523773</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">print</span>(q.lsa)</span></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
</div>
<div id="b" class="section level3">
<h3>6.B</h3>
<p>A <code>for</code> circulate is used to generate Monte Carlo pseudo
variables required for the experimental power of three correlation test,
including parametric and non-parametric ones.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>method <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>, <span class="st">&quot;kendall&quot;</span>, <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>p.pearson <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>p.kendall <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>p.spearman <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mu =</span> mu, <span class="at">Sigma =</span> sigma, <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[,<span class="dv">1</span>]</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data[,<span class="dv">2</span>]</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>  test1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y,</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>,</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>    <span class="at">exact =</span> <span class="cn">NULL</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">continuity =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>    p.pearson[j] <span class="ot">&lt;-</span> test1<span class="sc">$</span>p.value</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>  test2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y,</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,</span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>,</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>    <span class="at">exact =</span> <span class="cn">NULL</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">continuity =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>    p.kendall[j] <span class="ot">&lt;-</span> test2<span class="sc">$</span>p.value</span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>  test3 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y,</span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,</span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,</span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>    <span class="at">exact =</span> <span class="cn">NULL</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">continuity =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a>    p.spearman[j] <span class="ot">&lt;-</span> test3<span class="sc">$</span>p.value</span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a>}</span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(p.pearson <span class="sc">&lt;=</span> .<span class="dv">05</span>),<span class="fu">mean</span>(p.kendall <span class="sc">&lt;=</span> .<span class="dv">05</span>),<span class="fu">mean</span>(p.spearman <span class="sc">&lt;=</span> .<span class="dv">05</span>))</span></code></pre></div>
<p>As can be seen in the result, when the alternative <span class="math inline">\(\theta\)</span> equals to 0.6, the power of these
two non-parametric methods both surmount the parametric one.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">print</span>(method)</span></code></pre></div>
<pre><code>## [1] &quot;pearson&quot;  &quot;kendall&quot;  &quot;spearman&quot;</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.000 0.222 0.255</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:MASS&quot;</span>,<span class="at">unload =</span> T)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:e1071&quot;</span>,<span class="at">unload =</span> T)</span></code></pre></div>
</div>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
<div id="exercise-1" class="section level3">
<h3>exercise</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co">#定义条件</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>; N0 <span class="ot">&lt;-</span> <span class="dv">950</span>; alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>; a <span class="ot">&lt;-</span> <span class="fl">0.1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span>; m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="co">#定义四个向量用于存储MC实验的结果</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>FWER_B <span class="ot">&lt;-</span> FDR_B <span class="ot">&lt;-</span> TPR_B <span class="ot">&lt;-</span> FWER_BH <span class="ot">&lt;-</span> FDR_BH <span class="ot">&lt;-</span> TPR_BH <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a><span class="co">#形成一个包含950个1和50个0的向量并打乱顺序，表示1000个假设检验的真值，1表示原假设为真，0表示为假。</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>h[<span class="dv">1</span><span class="sc">:</span>N0] <span class="ot">&lt;-</span> <span class="dv">1</span>; h[(N0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(h,<span class="at">replace =</span> F)</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a><span class="co">#循环生成m次实验的各变量数据</span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>  <span class="co">#依据原假设和备择假设下p值的分布，生成随机的p值变量</span></span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>    <span class="cf">if</span> (h1[j]<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>      p[j] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>      p[j] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,a,b)</span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>    }</span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>  }</span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>  </span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>  <span class="co">#按照Bonferroni方法和B-H方法生成调整后的p值向量</span></span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>  p.adjB <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>  p.adjBH <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&#39;fdr&#39;</span>)</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>  orderp.BH <span class="ot">&lt;-</span> <span class="fu">rank</span>(p.adjBH)</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>  </span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>  <span class="co">#计算两种方法各自的四个随机变量FP,TP,TN,FN的值</span></span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a>  FP_B <span class="ot">&lt;-</span> TP_B <span class="ot">&lt;-</span> TN_B <span class="ot">&lt;-</span> FN_B <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>  FP_BH <span class="ot">&lt;-</span> TP_BH <span class="ot">&lt;-</span> TN_BH <span class="ot">&lt;-</span> FN_BH <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a>  </span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a>    <span class="cf">if</span> (h1[k]<span class="sc">==</span><span class="dv">1</span>) {</span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a>      <span class="cf">if</span> (p.adjB[k]<span class="sc">&lt;</span>(alpha<span class="sc">/</span>N)) {</span>
<span id="cb47-37"><a href="#cb47-37" tabindex="-1"></a>        FP_B <span class="ot">&lt;-</span> FP_B<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-38"><a href="#cb47-38" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb47-39"><a href="#cb47-39" tabindex="-1"></a>        TN_B <span class="ot">&lt;-</span> TN_B<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-40"><a href="#cb47-40" tabindex="-1"></a>      }</span>
<span id="cb47-41"><a href="#cb47-41" tabindex="-1"></a>      <span class="cf">if</span> (p.adjBH[k]<span class="sc">&lt;</span>(orderp.BH[k]<span class="sc">*</span>alpha<span class="sc">/</span>N)) {</span>
<span id="cb47-42"><a href="#cb47-42" tabindex="-1"></a>        FP_BH <span class="ot">&lt;-</span> FP_BH<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-43"><a href="#cb47-43" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb47-44"><a href="#cb47-44" tabindex="-1"></a>        TN_BH <span class="ot">&lt;-</span> TN_BH<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-45"><a href="#cb47-45" tabindex="-1"></a>      }</span>
<span id="cb47-46"><a href="#cb47-46" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb47-47"><a href="#cb47-47" tabindex="-1"></a>      <span class="cf">if</span> (p.adjB[k]<span class="sc">&lt;</span>(alpha<span class="sc">/</span>N)) {</span>
<span id="cb47-48"><a href="#cb47-48" tabindex="-1"></a>        TP_B <span class="ot">&lt;-</span> TP_B<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-49"><a href="#cb47-49" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb47-50"><a href="#cb47-50" tabindex="-1"></a>        FN_B <span class="ot">&lt;-</span> FN_B<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-51"><a href="#cb47-51" tabindex="-1"></a>      }</span>
<span id="cb47-52"><a href="#cb47-52" tabindex="-1"></a>      <span class="cf">if</span> (p.adjBH[k]<span class="sc">&lt;</span>(orderp.BH[k]<span class="sc">*</span>alpha<span class="sc">/</span>N)) {</span>
<span id="cb47-53"><a href="#cb47-53" tabindex="-1"></a>        TP_BH <span class="ot">&lt;-</span> TP_BH<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-54"><a href="#cb47-54" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb47-55"><a href="#cb47-55" tabindex="-1"></a>        FN_BH <span class="ot">&lt;-</span> FN_BH<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb47-56"><a href="#cb47-56" tabindex="-1"></a>      }</span>
<span id="cb47-57"><a href="#cb47-57" tabindex="-1"></a>    }</span>
<span id="cb47-58"><a href="#cb47-58" tabindex="-1"></a>  }</span>
<span id="cb47-59"><a href="#cb47-59" tabindex="-1"></a>  </span>
<span id="cb47-60"><a href="#cb47-60" tabindex="-1"></a>  <span class="co">#基于循环结果给第i次实验的各随机变量赋值</span></span>
<span id="cb47-61"><a href="#cb47-61" tabindex="-1"></a>  TPR_B[i] <span class="ot">&lt;-</span> TP_B<span class="sc">/</span>(N<span class="sc">-</span>N0)</span>
<span id="cb47-62"><a href="#cb47-62" tabindex="-1"></a>  TPR_BH[i] <span class="ot">&lt;-</span> TP_BH<span class="sc">/</span>(N<span class="sc">-</span>N0)</span>
<span id="cb47-63"><a href="#cb47-63" tabindex="-1"></a>  FDR_B[i] <span class="ot">&lt;-</span> FP_B<span class="sc">/</span>(FP_B<span class="sc">+</span>TP_B)</span>
<span id="cb47-64"><a href="#cb47-64" tabindex="-1"></a>  FDR_BH[i] <span class="ot">&lt;-</span> FP_BH<span class="sc">/</span>(FP_BH<span class="sc">+</span>TP_BH)</span>
<span id="cb47-65"><a href="#cb47-65" tabindex="-1"></a>  FWER_B[i] <span class="ot">&lt;-</span> FP_B<span class="sc">&gt;=</span><span class="dv">1</span></span>
<span id="cb47-66"><a href="#cb47-66" tabindex="-1"></a>  FWER_BH[i] <span class="ot">&lt;-</span> FP_BH<span class="sc">&gt;=</span><span class="dv">1</span></span>
<span id="cb47-67"><a href="#cb47-67" tabindex="-1"></a>}</span>
<span id="cb47-68"><a href="#cb47-68" tabindex="-1"></a></span>
<span id="cb47-69"><a href="#cb47-69" tabindex="-1"></a><span class="co">#将10000次MC实验的平均结果展示在表格中</span></span>
<span id="cb47-70"><a href="#cb47-70" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(FWER_B),<span class="fu">mean</span>(FWER_BH),</span>
<span id="cb47-71"><a href="#cb47-71" tabindex="-1"></a>                   <span class="fu">mean</span>(FDR_B),<span class="fu">mean</span>(FDR_BH),</span>
<span id="cb47-72"><a href="#cb47-72" tabindex="-1"></a>                   <span class="fu">mean</span>(TPR_B),<span class="fu">mean</span>(TPR_BH)),</span>
<span id="cb47-73"><a href="#cb47-73" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T),<span class="dv">6</span>)</span>
<span id="cb47-74"><a href="#cb47-74" tabindex="-1"></a><span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb47-75"><a href="#cb47-75" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb47-76"><a href="#cb47-76" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER              0.000000       0.034000
## FDR               0.000000       0.001736
## TPR               0.198868       0.354946</code></pre>
</div>
<div id="section-5" class="section level3">
<h3>7.4</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">100</span>; lambdastar <span class="ot">&lt;-</span> <span class="fu">c</span>(); lambdahat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(t)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  tstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(t,<span class="at">replace =</span> T)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>  lambdastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(tstar)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>}</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span><span class="fu">mean</span>(lambdastar)<span class="sc">-</span>lambdahat,<span class="at">se=</span><span class="fu">sd</span>(lambdastar)),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##     bias       se 
## 0.000797 0.005149</code></pre>
</div>
<div id="section-6" class="section level3">
<h3>7.5</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>); B <span class="ot">&lt;-</span> <span class="dv">100</span>; m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a><span class="co">#定义需要boot函数返回的统计量</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a><span class="co">#使用boot函数得到重抽样结果记录在boot.result中</span></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>bootresult <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>t, <span class="at">statistic =</span> xbar, <span class="at">R=</span>B)</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a><span class="co">#构造一个m个向量元素组成的向量，用来装MC实验得到的单个样本</span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> ci.bca <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a><span class="co">#使用结果计算置信区间(使用suppress函数阻止警告信息显示)</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a><span class="fu">suppressWarnings</span>({<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootresult,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a>  ci.norm[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],ci<span class="sc">$</span>norm[<span class="dv">3</span>]<span class="sc">-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span>])</span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>  ci.basic[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],ci<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span>])</span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>  ci.perc[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],ci<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span>])</span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a>  ci.bca[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],ci<span class="sc">$</span>bca[<span class="dv">5</span>]<span class="sc">-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span>])</span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a>}})</span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a></span>
<span id="cb51-23"><a href="#cb51-23" tabindex="-1"></a><span class="co">#将结果展示在一个4*3的表格中</span></span>
<span id="cb51-24"><a href="#cb51-24" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb51-25"><a href="#cb51-25" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]),<span class="fu">mean</span>(ci.norm[,<span class="dv">3</span>])),</span>
<span id="cb51-26"><a href="#cb51-26" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]),<span class="fu">mean</span>(ci.basic[,<span class="dv">3</span>])),</span>
<span id="cb51-27"><a href="#cb51-27" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]),<span class="fu">mean</span>(ci.perc[,<span class="dv">3</span>])),</span>
<span id="cb51-28"><a href="#cb51-28" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.bca[,<span class="dv">2</span>]),<span class="fu">mean</span>(ci.bca[,<span class="dv">3</span>])))</span>
<span id="cb51-29"><a href="#cb51-29" tabindex="-1"></a><span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>,<span class="st">&quot;per&quot;</span>,<span class="st">&quot;bca&quot;</span>)</span>
<span id="cb51-30"><a href="#cb51-30" tabindex="-1"></a><span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>,<span class="st">&quot;len&quot;</span>)</span>
<span id="cb51-31"><a href="#cb51-31" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##           lower    upper      len
## norm  18.896523 179.5568 160.6603
## basic -3.257334 162.6511 165.9084
## per   53.515554 219.4240 165.9084
## bca   58.217280 225.8333 167.6161</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:boot&quot;</span>,<span class="at">unload =</span> T)</span></code></pre></div>
<p>从结果看出basic和percentile法构造的，这两者区别只体现在上下限上，percentile法构造的范围更加高估了参数的值。在多次实验中，大部分是norm法构造的区间最短，但也不是绝对的。他们之间的区别来源于假设，norm法假设统计量有较好的渐进正态性，在重抽样次数足够大时较为准确，而basic和percentile假设统计量的某个函数在样本的条件分布下有较好的渐进正态性。</p>
</div>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
<div id="section-7" class="section level3">
<h3>7.8</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co">#Jack-knife estimate for Variance contribution rate of the first principal component</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>jkfcr <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x); p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  sig0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x); fcr0 <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sig0)<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">eigen</span>(sig0)<span class="sc">$</span>values)</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>  fcr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>    xjk <span class="ot">&lt;-</span> x[<span class="sc">-</span>i,]</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>    sig <span class="ot">&lt;-</span> <span class="fu">cor</span>(xjk)</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>    eigen_result <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sig)</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>    eigen_value <span class="ot">&lt;-</span> eigen_result<span class="sc">$</span>values</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>    fcr[i] <span class="ot">&lt;-</span> eigen_value[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigen_value)</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  }</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias =</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(fcr)<span class="sc">-</span>fcr0),</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>                    <span class="at">se =</span> <span class="fu">sqrt</span>(((n<span class="dv">-1</span>)<span class="sc">/</span>n)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(fcr))),<span class="dv">6</span>)</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co">#Load the bootsrap package to get the data named &#39;scor&#39;, get its Jack-knife estimate&#39; s bias and stand error</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> scor<span class="sc">$</span>mec,<span class="at">x2 =</span> scor<span class="sc">$</span>vec,</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>                <span class="at">x3 =</span> scor<span class="sc">$</span>alg,<span class="at">x4 =</span> scor<span class="sc">$</span>ana,<span class="at">x5 =</span> scor<span class="sc">$</span>sta)</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a><span class="fu">jkfcr</span>(x)</span></code></pre></div>
<pre><code>##      bias        se 
## -0.000378  0.044667</code></pre>
</div>
<div id="section-8" class="section level3">
<h3>7.10</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="co">#function to asses regression models based on n-fold residuals or R^2</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="co">#method == nfold for n-fold, method == R2 for R^2</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>assessmodel <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,<span class="at">method =</span><span class="st">&quot;nfold&quot;</span>){</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="st">&quot;nfold&quot;</span>){</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n) {</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>      yn <span class="ot">&lt;-</span> y[<span class="sc">-</span>i]; xn <span class="ot">&lt;-</span> x[<span class="sc">-</span>i]</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>      J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yn<span class="sc">~</span>xn); J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yn <span class="sc">~</span> xn <span class="sc">+</span> <span class="fu">I</span>(xn<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>      J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(yn) <span class="sc">~</span> xn); J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yn <span class="sc">~</span> xn <span class="sc">+</span> <span class="fu">I</span>(xn<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(xn<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>      yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x[i]</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>      yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x[i]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>x[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>      yhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x[i]</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a>      yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>x[i]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>x[i]<span class="sc">^</span><span class="dv">2</span><span class="sc">++</span>J4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>x[i]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a>      e1[i] <span class="ot">&lt;-</span> y[i]<span class="sc">-</span>yhat1; e2[i] <span class="ot">&lt;-</span> y[i]<span class="sc">-</span>yhat2;</span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a>      e3[i] <span class="ot">&lt;-</span> y[i]<span class="sc">-</span>yhat3; e4[i] <span class="ot">&lt;-</span> y[i]<span class="sc">-</span>yhat4</span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a>    }</span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;n-fold&quot;</span>)</span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a>                      <span class="st">&quot;Quardratic&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a>                      <span class="st">&quot;Exponential&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a>                      <span class="st">&quot;Cubic&quot;</span> <span class="ot">=</span> <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">4</span>)</span>
<span id="cb57-22"><a href="#cb57-22" tabindex="-1"></a>    <span class="fu">return</span>(result)</span>
<span id="cb57-23"><a href="#cb57-23" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(method<span class="sc">==</span><span class="st">&quot;R2&quot;</span>){</span>
<span id="cb57-24"><a href="#cb57-24" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x); J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb57-25"><a href="#cb57-25" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x); J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb57-26"><a href="#cb57-26" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;R^2&quot;</span>)</span>
<span id="cb57-27"><a href="#cb57-27" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(J1)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb57-28"><a href="#cb57-28" tabindex="-1"></a>                      <span class="st">&quot;Quardratic&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(J2)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb57-29"><a href="#cb57-29" tabindex="-1"></a>                      <span class="st">&quot;Exponential&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(J3)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb57-30"><a href="#cb57-30" tabindex="-1"></a>                      <span class="st">&quot;Cubic&quot;</span> <span class="ot">=</span> <span class="fu">summary</span>(J4)<span class="sc">$</span>adj.r.squared),<span class="dv">4</span>)</span>
<span id="cb57-31"><a href="#cb57-31" tabindex="-1"></a>    <span class="fu">return</span>(result)</span>
<span id="cb57-32"><a href="#cb57-32" tabindex="-1"></a>  }</span>
<span id="cb57-33"><a href="#cb57-33" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">assessmodel</span>(ironslag<span class="sc">$</span>magnetic, ironslag<span class="sc">$</span>chemical, <span class="at">method =</span> <span class="st">&quot;nfold&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;n-fold&quot;</code></pre>
<pre><code>##      Linear  Quardratic Exponential       Cubic 
##      0.2513      0.2068      8.8230      0.3153</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">assessmodel</span>(ironslag<span class="sc">$</span>magnetic, ironslag<span class="sc">$</span>chemical, <span class="at">method =</span> <span class="st">&quot;R2&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;R^2&quot;</code></pre>
<pre><code>##      Linear  Quardratic Exponential       Cubic 
##      0.5282      0.5309      0.4743      0.5295</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:bootstrap&quot;</span>,<span class="at">unload =</span> T)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:DAAG&quot;</span>,<span class="at">unload =</span> T)</span></code></pre></div>
<p>结果如上，按照n-fold回归残差标准和R^2标准均应当选择Quardratic模型。</p>
</div>
<div id="section-9" class="section level3">
<h3>8.1</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co">#Define a function for two-sample Cram ́er-von Mises test for equal distributions</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="co">#method = 1 or 2 represent two different ways to generate permuted samples</span></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>cm.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">alternative =</span> <span class="st">&quot;twosided&quot;</span>, <span class="at">method =</span> <span class="dv">1</span>){</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y); n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y); K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(m<span class="sc">+</span>n); R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  W2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R); W20 <span class="ot">&lt;-</span> (m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">ecdf</span>(x)(z)<span class="sc">-</span><span class="fu">ecdf</span>(y)(z))<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {<span class="co">#generate permutated sample x and y</span></span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>    <span class="cf">if</span>(method<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>      k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K,<span class="at">size =</span> n,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> z[k]; ystar <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>      xy <span class="ot">&lt;-</span> <span class="fu">c</span>(xstar,ystar)</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span>(method<span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>      xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z)</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>n]; ystar <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>    }</span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>    W2[i] <span class="ot">&lt;-</span> (m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sum</span>((<span class="fu">ecdf</span>(xstar)(xy)<span class="sc">-</span><span class="fu">ecdf</span>(ystar)(xy))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>  }</span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>  <span class="cf">if</span>(alternative <span class="sc">==</span> <span class="st">&quot;twosided&quot;</span>){</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(W20,W2)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(W20))</span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(alternative <span class="sc">==</span> <span class="st">&quot;rightsided&quot;</span>){</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(W20,W2) <span class="sc">&gt;=</span> W20)</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(alternative <span class="sc">==</span> <span class="st">&quot;leftsided&quot;</span>){</span>
<span id="cb65-24"><a href="#cb65-24" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(W20,W2) <span class="sc">&lt;=</span> W20)</span>
<span id="cb65-25"><a href="#cb65-25" tabindex="-1"></a>  }</span>
<span id="cb65-26"><a href="#cb65-26" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb65-27"><a href="#cb65-27" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="co">#example8.1</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>])) </span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])) </span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>p_cm1 <span class="ot">&lt;-</span> <span class="fu">cm.test</span>(x,y)</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a><span class="co">#example8.2</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])) </span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])) </span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>p_cm2 <span class="ot">&lt;-</span> <span class="fu">cm.test</span>(x,y)</span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">&quot;soybean-linseed&quot;</span> <span class="ot">=</span> p_cm1, <span class="st">&quot;sunflower-linseed&quot;</span> <span class="ot">=</span> p_cm2))</span></code></pre></div>
<pre><code>##   soybean-linseed sunflower-linseed 
##             0.361             0.001</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span></code></pre></div>
<p>结果与书上使用t统计量相差不大。</p>
</div>
<div id="section-10" class="section level3">
<h3>8.2</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co">#Define a function for two-sample Spearman rank corelation test for independency</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>sp.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">alternative =</span> <span class="st">&quot;twosided&quot;</span>){</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y); n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  <span class="cf">if</span>(m<span class="sc">!=</span>n){</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;Wrong, the lenth of x should be equal to y.&quot;</span>)</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>  }</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>  s_rank <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R); s_rank0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>) </span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {<span class="co">#generate permuted sample y to match original x</span></span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>    xstar <span class="ot">&lt;-</span> x; ystar <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>    s_rank[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(xstar,ystar,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>  }</span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>  <span class="cf">if</span>(alternative <span class="sc">==</span> <span class="st">&quot;twosided&quot;</span>){</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(s_rank0,s_rank)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(s_rank0))</span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(alternative <span class="sc">==</span> <span class="st">&quot;rightsided&quot;</span>){</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(s_rank0,s_rank) <span class="sc">&gt;=</span> s_rank0)</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(alternative <span class="sc">==</span> <span class="st">&quot;leftsided&quot;</span>){</span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(s_rank0,s_rank) <span class="sc">&lt;=</span> s_rank0)</span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>  }</span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="fu">Sys.time</span>()); <span class="fu">library</span>(MASS)</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; miu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>); sig <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n,miu,sig)</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> data[,<span class="dv">1</span>]; y <span class="ot">&lt;-</span> data[,<span class="dv">2</span>]</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&quot;Spearman correlation&quot;</span> <span class="ot">=</span> <span class="fu">sp.test</span>(x,y), </span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>        <span class="st">&quot;cor.test&quot;</span> <span class="ot">=</span> <span class="fu">cor.test</span>(x,y)<span class="sc">$</span>p.value),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Spearman correlation             cor.test 
##             0.157000             0.026859</code></pre>
<p>按照spearman秩相关性检验统计量得到的p值和cor.test函数得到的p值如上，两者多数时候相差不大。</p>
</div>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
<div id="section-11" class="section level3">
<h3>9.3</h3>
<p>定义一个柯西分布的Metropolis-Hasting样本生成器。</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>mh_cauchy_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n,burn,<span class="at">theta =</span> <span class="dv">1</span>,<span class="at">eta =</span> <span class="dv">0</span>){</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>); x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  rxy <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">dcauchy</span>(y,<span class="at">location =</span> eta,<span class="at">scale =</span> theta)<span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean =</span> y,<span class="at">sd =</span> <span class="dv">1</span>))<span class="sc">/</span></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>             (<span class="fu">dcauchy</span>(x,<span class="at">location =</span> eta,<span class="at">scale =</span> theta)<span class="sc">*</span><span class="fu">dnorm</span>(y,<span class="at">mean =</span> x,<span class="at">sd =</span> <span class="dv">1</span>)))</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  }</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean =</span> xt,<span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>    <span class="cf">if</span> (u<span class="sc">&lt;=</span><span class="fu">rxy</span>(xt,y)) {</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>    }</span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>  }</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>  <span class="fu">return</span>(x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n])</span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50000</span>; burn <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>MH_random_variables <span class="ot">&lt;-</span> <span class="fu">mh_cauchy_sample</span>(n, burn)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="co">#生成样本和理论值的十分位数</span></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>theoretic_value <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>sample_value <span class="ot">&lt;-</span> <span class="fu">quantile</span>(MH_random_variables,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(theoretic_value,sample_value),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                    10%    20%    30%    40%   50%   60%   70%   80%   90%
## theoretic_value -3.078 -1.376 -0.727 -0.325 0.000 0.325 0.727 1.376 3.078
## sample_value    -3.030 -1.309 -0.700 -0.302 0.034 0.369 0.786 1.492 3.657</code></pre>
</div>
<div id="section-12" class="section level3">
<h3>9.8</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co">#定义生成gibbs方法的随机样本，输入参数n，a，b，burn，m输出样本</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>gibbs_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(m, burn, a, b, n) {</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>    x[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">size =</span> n,<span class="at">prob =</span> x2)</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> x[i,<span class="dv">1</span>]</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>    x[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="dv">1</span>,<span class="at">shape1 =</span> (x1<span class="sc">+</span>a),<span class="at">shape2 =</span> (n<span class="sc">-</span>x1<span class="sc">+</span>b))</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  }</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>  <span class="fu">return</span>(x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m,])</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">50000</span>; a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span>; burn <span class="ot">&lt;-</span> <span class="dv">10000</span>; n <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>GBS_random_variables <span class="ot">&lt;-</span> <span class="fu">gibbs_sample</span>(m,burn,a,b,n)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a><span class="fu">head</span>(GBS_random_variables)</span></code></pre></div>
<pre><code>##      [,1]      [,2]
## [1,]    1 0.4067577
## [2,]    1 0.7136183
## [3,]    2 0.8463203
## [4,]    2 0.8146945
## [5,]    2 0.7822305
## [6,]    1 0.1803388</code></pre>
</div>
<div id="exercise-2" class="section level3">
<h3>exercise</h3>
<p>对上面的两个样本生成器应用Gelman-Rubin方法检测收敛性。</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) { </span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi) </span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi) </span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)  </span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) </span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) </span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est. </span></span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) </span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v.hat <span class="sc">/</span> W)  </span>
<span id="cb78-11"><a href="#cb78-11" tabindex="-1"></a>  <span class="fu">return</span>(r.hat) </span>
<span id="cb78-12"><a href="#cb78-12" tabindex="-1"></a>}</span>
<span id="cb78-13"><a href="#cb78-13" tabindex="-1"></a>grtest <span class="ot">&lt;-</span> <span class="cf">function</span>(n,<span class="at">k =</span> <span class="dv">4</span>, method){</span>
<span id="cb78-14"><a href="#cb78-14" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span>; burn <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb78-15"><a href="#cb78-15" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> k,<span class="at">ncol =</span> n<span class="sc">-</span>burn)</span>
<span id="cb78-16"><a href="#cb78-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb78-17"><a href="#cb78-17" tabindex="-1"></a>    <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;MH&#39;</span>) {</span>
<span id="cb78-18"><a href="#cb78-18" tabindex="-1"></a>      x[i,] <span class="ot">&lt;-</span> <span class="fu">mh_cauchy_sample</span>(n, burn)</span>
<span id="cb78-19"><a href="#cb78-19" tabindex="-1"></a>      psi <span class="ot">&lt;-</span> (<span class="fu">t</span>(<span class="fu">apply</span>(x,<span class="dv">1</span>,cumsum)))</span>
<span id="cb78-20"><a href="#cb78-20" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb78-21"><a href="#cb78-21" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb78-22"><a href="#cb78-22" tabindex="-1"></a>      }</span>
<span id="cb78-23"><a href="#cb78-23" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span> (method<span class="sc">==</span><span class="st">&#39;GBS&#39;</span>) {</span>
<span id="cb78-24"><a href="#cb78-24" tabindex="-1"></a>      x[i,] <span class="ot">&lt;-</span> <span class="fu">gibbs_sample</span>(n,a,b,burn)</span>
<span id="cb78-25"><a href="#cb78-25" tabindex="-1"></a>    }</span>
<span id="cb78-26"><a href="#cb78-26" tabindex="-1"></a>  }</span>
<span id="cb78-27"><a href="#cb78-27" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">Gelman.Rubin</span>(psi))</span>
<span id="cb78-28"><a href="#cb78-28" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">grtest</span>(<span class="dv">10000</span>,<span class="at">method =</span> <span class="st">&#39;MH&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 0.99995</code></pre>
<p>结果显示在n为10000时，Rhat统计量达到0.999，收敛性较好。</p>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
<div id="section-13" class="section level3">
<h3>11.3</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="co">#定义函数用于计算第k项的值</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>kvalue <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>  v <span class="ot">&lt;-</span> ((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k)<span class="sc">*</span><span class="dv">2</span><span class="sc">^</span>k)<span class="sc">*</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>    (<span class="fu">norm</span>(a,<span class="at">type =</span> <span class="st">&#39;2&#39;</span>)<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)))<span class="sc">*</span></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>    (<span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">gamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>  <span class="fu">return</span>(v)</span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>}</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a><span class="co">#定义函数用于求和，保证其收敛到与真值误差在一定范围内</span></span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>asum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, <span class="at">tol =</span> <span class="fl">1e-5</span>){</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>  s <span class="ot">&lt;-</span> k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>  <span class="cf">while</span>(<span class="dv">1</span>){</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>    sk <span class="ot">&lt;-</span> <span class="fu">kvalue</span>(a,k)</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(sk)<span class="sc">&lt;=</span>tol) {</span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>      s <span class="ot">&lt;-</span> s<span class="sc">+</span>sk</span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a>    }</span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a>  }</span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="fu">list</span>(<span class="at">sum=</span>s,<span class="at">term=</span>k<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a>}</span></code></pre></div>
<p>使用定义的函数计算对a向量使用该求和的数值解，绝对误差设定为1e-10内，结果为1.044058，且可以看出共计算了前38项的和结果就收敛到一个较稳定的值了。</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">asum</span>(a,<span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>sum)</span></code></pre></div>
<pre><code>## [1] 1.044058</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>term)</span></code></pre></div>
<pre><code>## [1] 38</code></pre>
</div>
<div id="section-14" class="section level3">
<h3>11.5</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co">#定义一个函数用于解固定的k与k+1相等时a的值</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>avalue <span class="ot">&lt;-</span> <span class="cf">function</span>(k,<span class="at">tol=</span><span class="fl">1e-5</span>){</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>  <span class="co">#g用于对输入的值a计算某个给定的ck上限的积分</span></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(k)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>  </span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>  <span class="co">#A函数为需要解的方程</span></span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>    <span class="co">#定义一个函数计算某项积分的值</span></span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>    integral <span class="ot">&lt;-</span> <span class="cf">function</span>(a,k){</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>      f <span class="ot">&lt;-</span> <span class="cf">function</span>(u){(<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(<span class="dv">1</span><span class="sc">+</span>k)<span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>      c <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k)<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>      <span class="fu">return</span>((<span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="fu">sqrt</span>(pi<span class="sc">*</span>k)<span class="sc">*</span><span class="fu">gamma</span>(k<span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>             <span class="sc">*</span><span class="fu">integrate</span>(f,<span class="dv">0</span>,c)<span class="sc">$</span>value)</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>    }</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">integral</span>(a,k)<span class="sc">-</span><span class="fu">integral</span>(a,k<span class="dv">-1</span>))</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>  }</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>  </span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a>  <span class="co">#dA为A函数在a点的导数数值解</span></span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>  dA <span class="ot">&lt;-</span> <span class="cf">function</span>(a,<span class="at">h=</span>tol<span class="sc">/</span><span class="dv">100</span>){(<span class="fu">A</span>(a<span class="sc">+</span>h)<span class="sc">-</span><span class="fu">A</span>(a))<span class="sc">/</span>h}</span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>  </span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>  <span class="co">#使用newton-raphson算法进行迭代</span></span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>  <span class="cf">while</span>(<span class="dv">1</span>){</span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a>    a <span class="ot">&lt;-</span> a<span class="sc">-</span><span class="fu">A</span>(a)<span class="sc">/</span><span class="fu">dA</span>(a)</span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(<span class="fu">A</span>(a)<span class="sc">/</span><span class="fu">dA</span>(a))<span class="sc">&lt;=</span>tol){</span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a>    }</span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a>  }</span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> k){</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(a,<span class="fu">avalue</span>(i))</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>}</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a><span class="fu">plot</span>(k,a)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3" class="section level3">
<h3>exercise</h3>
</div>
</div>
<div id="实验思路如下" class="section level1">
<h1>实验思路如下：</h1>
<div id="em算法的理论步骤是根据以下关系" class="section level3">
<h3>EM算法的理论步骤是根据以下关系：</h3>
<p><span class="math display">\[T=(T_1,T_2,...,T_n)表示不可观测的原量，满足T \sim
EXP(\frac{1}{\lambda})\]</span> <span class="math display">\[Y=(Y_1,Y_2,...,Y_n)为观测到的变量，他们满足Y_i=T_i
I(T_i \leq\tau)+\tau I(T_i &gt;\tau)\]</span> <span class="math display">\[所以第i步得到的估计量为\hat{\lambda}^{i+1} =
arg\max_{\lambda}E_{T|Y,\hat{\lambda}^i}[\log
P(Y,T|\lambda)]\]</span></p>
</div>
<div id="下面给出上述步骤中需要用到的量的关于样本的显示表达式" class="section level3">
<h3>下面给出上述步骤中需要用到的量的关于样本的显示表达式</h3>
<p><span class="math display">\[\log P(Y,T|\lambda) = \log
P(Y_1,...Y_n,T_1,...,T_n|\lambda)\]</span></p>
</div>
<div id="由于每个t_i确定后y_i唯一确定上式转化为" class="section level3">
<h3>由于每个<span class="math inline">\(T_i\)</span>确定后<span class="math inline">\(Y_i\)</span>唯一确定，上式转化为</h3>
<p><span class="math display">\[\log P(Y,T|\lambda) = \log
P(T_1,...,T_n|\lambda)=\sum_{i=1}^{n}\log P(T_i|\lambda)=\sum_{i=1}^{n}(
-\log(\lambda) - \frac{T_i}{\lambda})\]</span></p>
</div>
<div id="于是最开始的迭代公式转化为" class="section level3">
<h3>于是，最开始的迭代公式转化为</h3>
<p><span class="math display">\[E_{T|Y,\hat{\lambda}^i}[\log
P(Y,T|\lambda)]=E_{T|Y,\hat{\lambda}^i}[\sum_{i=1}^{n}( -\log(\lambda) -
\frac{T_i}{\lambda})]=-n\log(\lambda)-\frac{1}{\lambda}\sum_{i=1}^{n}E_{T|Y,\hat{\lambda}^i}(T_i)\]</span></p>
</div>
<div id="下面研究式中期望的函数形式由于诸样本独立所以t_i只与y_i有关t_i关于tylambda的条件期望可写成如下形式" class="section level3">
<h3>下面研究式中期望的函数形式。由于诸样本独立，所以<span class="math inline">\(T_i\)</span>只与<span class="math inline">\(Y_i\)</span>有关，<span class="math inline">\(T_i\)</span>关于<span class="math inline">\(T|Y,\lambda\)</span>的条件期望可写成如下形式</h3>
<p><span class="math display">\[E_{T|Y,\hat{\lambda}^i}(T_i)=E(T_i|Y,\hat{\lambda}^i)=E(T_i|Y_i,\hat{\lambda}^i)\]</span>
### 由于<span class="math inline">\(Y_i\)</span>的取值有如下形式</p>
<p><span class="math display">\[Y_i = \begin{cases} y_i &amp; \text{if }
T_i=y_i &lt; \tau \\ \tau &amp; \text{if } T_i=y_i \geq \tau
\end{cases}\]</span></p>
</div>
<div id="因此由样本决定的et_iy_ilambda也可以分为两种情况讨论当y_itau时" class="section level3">
<h3>因此由样本决定的<span class="math inline">\(E(T_i|Y_i,\lambda)\)</span>也可以分为两种情况讨论,当<span class="math inline">\(y_i=\tau\)</span>时</h3>
<p><span class="math display">\[E(T_i|Y_i=\tau,\hat{\lambda}^i)=E(T_i|T_i \geq
\tau,\hat{\lambda}^i)=\frac{E(T_i*I(T_i\geq\tau)|\hat{\lambda}^i)}{P(T_i\geq\tau|\hat{\lambda}^i)}=\tau+\hat{\lambda}^i\]</span>
### 而对于<span class="math inline">\(y_i &lt;
\tau\)</span>时，有如下</p>
<p><span class="math display">\[E(T_i|Y_i=y_i &lt;
\tau,\hat{\lambda}^i)=\sum_{t\in
R}tP(T_i=t|Y_i=y_i&lt;\tau,\hat{\lambda}^i)=y_iP(T_i=y_i|Y_i=y_i&lt;\tau,\hat{\lambda}^i)=y_i\]</span>
### 综上所述所求期望估计量可表示为</p>
<p><span class="math display">\[E_{T|Y,\hat{\lambda}^i}[\log
P(Y,T|\lambda)] = \begin{cases} -n\log (\lambda)-\frac{1}{\lambda}
\sum_{i=1}^{n} y_i &amp; \text{if } Y_i=y_i &lt; \tau \\ -n\log
(\lambda)-\frac{1}{\lambda} \sum_{i=1}^{n}(\tau+\hat{\lambda}^i) &amp;
\text{if } Y_i=y_i = \tau \end{cases}\]</span> ##
接下来分析EM算法的具体步骤：</p>
</div>
<div id="e步赋予hatlambda0一个合理的初始值比如y_i的样本平均数再以样本最大值作为tau的估计这是几乎必然的再根据公式" class="section level3">
<h3>1.E步：赋予<span class="math inline">\(\hat{\lambda}^0\)</span>一个合理的初始值，比如<span class="math inline">\(Y_i\)</span>的样本平均数，再以样本最大值作为<span class="math inline">\(\tau\)</span>的估计（这是几乎必然的），再根据公式</h3>
<p><span class="math display">\[E_{T|Y,\hat{\lambda}^i}[\log
P(Y,T|\lambda)] = \begin{cases} -n\log (\lambda)-\frac{1}{\lambda}
\sum_{i=1}^{n} y_i &amp; \text{if } Y_i=y_i &lt; \tau \\ -n\log
(\lambda)-\frac{1}{\lambda} \sum_{i=1}^{n}(\tau+\hat{\lambda}^i) &amp;
\text{if } Y_i=y_i = \tau \end{cases}\]</span>
计算隐变量对观测变量的条件期望。</p>
</div>
<div id="m步" class="section level3">
<h3>2.M步：</h3>
<p><span class="math display">\[\hat{\lambda}^{i+1} =
arg\max_{\lambda}E_{T|Y,\hat{\lambda}^i}[\log P(Y,T|\lambda)]\]</span>
### 根据上式公式对<span class="math inline">\(\hat{\lambda}^{i}\)</span>进行迭代至其收敛。具体编程实现见下方。</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>EM_lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(y,<span class="at">tol =</span> <span class="fl">1e-5</span>, <span class="at">max_iter =</span> <span class="dv">100</span>){</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y); lambda0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y); tau <span class="ot">&lt;-</span> <span class="fu">max</span>(y); k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>  <span class="cf">while</span> (<span class="dv">1</span>) {</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>    ety <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>      <span class="cf">if</span> (y[i]<span class="sc">&lt;</span>tau) {</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>        ety[i] <span class="ot">&lt;-</span> y[i]</span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>        ety[i] <span class="ot">&lt;-</span> tau<span class="sc">+</span>lambda0</span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>      }</span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a>    }</span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>    Et_y <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>      <span class="fu">return</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>n<span class="sc">*</span><span class="fu">log</span>(lambda)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>lambda)<span class="sc">*</span><span class="fu">sum</span>(ety))</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>    }</span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>    lambda1 <span class="ot">&lt;-</span> <span class="fu">optimize</span>(Et_y,<span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> <span class="dv">10</span>,<span class="at">maximum =</span> T)<span class="sc">$</span>maximum</span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda0<span class="sc">-</span>lambda1)<span class="sc">&lt;=</span>tol <span class="sc">|</span> k <span class="sc">==</span> <span class="dv">100</span>) {</span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>      <span class="fu">return</span>(lambda1)</span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a>      lambda0 <span class="ot">&lt;-</span> lambda1</span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a>    }</span>
<span id="cb88-22"><a href="#cb88-22" tabindex="-1"></a>  }</span>
<span id="cb88-23"><a href="#cb88-23" tabindex="-1"></a>}</span></code></pre></div>
<p>另一方面，由<span class="math inline">\(Y_i\)</span>的形式，可写出如下的MLE算法。</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>MLE_lambda <span class="ot">&lt;-</span> <span class="cf">function</span>(y){</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y); tau <span class="ot">&lt;-</span> <span class="fu">max</span>(y)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  loglike <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>    lly <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>      <span class="cf">if</span> (y[i]<span class="sc">&lt;</span>tau) {</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>        lly[i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(lambda)<span class="sc">-</span>y[i]<span class="sc">/</span>lambda</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>        lly[i] <span class="ot">&lt;-</span> <span class="sc">-</span>tau<span class="sc">/</span>lambda</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>      }</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>    }</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(lly))</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>  }</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>  lambdahat <span class="ot">&lt;-</span> <span class="fu">optimize</span>(loglike,<span class="at">lower =</span> <span class="dv">0</span>,<span class="at">upper =</span> <span class="dv">10</span>,<span class="at">maximum =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>maximum</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>  <span class="fu">return</span>(lambdahat)</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>}</span></code></pre></div>
<p>对y向量使用EM算法和MLE法得出的估计值在0.964附近，且差值极小。而y的均值为0.675，这一事实符合直觉，因为对于较大的<span class="math inline">\(T_i\)</span>值实际只能观测到<span class="math inline">\(\tau\)</span>，因此直接使用y的均值会低估真实的期望值<span class="math inline">\(\lambda\)</span>。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">EM_lambda=</span><span class="fu">EM_lambda</span>(y),<span class="at">MLE_lambda=</span><span class="fu">MLE_lambda</span>(y),<span class="at">mean_lambda=</span><span class="fu">mean</span>(y)),<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##   EM_lambda  MLE_lambda mean_lambda 
##    0.964287    0.964288    0.675000</code></pre>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
<div id="section-15" class="section level3">
<h3>11.7</h3>
<p>求解优化问题。</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">9</span>)</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a><span class="fu">simplex</span>(<span class="at">a=</span>a,<span class="at">A1=</span>A1,<span class="at">b1=</span>b1,<span class="at">maxi =</span> T)</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = T)
## 
## Maximization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
##   x1   x2   x3 
## 0.00 0.75 1.25 
## The optimal value of the objective  function is 12.75.</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:boot&quot;</span>,<span class="at">unload =</span> T)</span></code></pre></div>
</div>
<div id="advanced-r-p204-3" class="section level3">
<h3>Advanced R p204 3</h3>
<p>用lapply函数写一个回归。</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>)</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>out1_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formulas) <span class="fu">lm</span>(<span class="at">formula =</span> formulas, <span class="at">data =</span> mtcars))</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(formulas)</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>out1_forloop <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="at">length =</span> n)</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  out1_forloop[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> formulas[[i]],<span class="at">data =</span> mtcars)</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="advanced-r-p204-4" class="section level3">
<h3>Advanced R p204 4</h3>
<p>不用匿名函数用lapply写出一个bootstrap。</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>})</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>out2_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>out2_forloop <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="at">length =</span> n)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  bootstraps <span class="ot">&lt;-</span> mtcars[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars),<span class="at">rep =</span> T),]</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  out2_forloop [[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> mpg <span class="sc">~</span> disp,<span class="at">data =</span> bootstraps)</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="advanced-r-p204-5" class="section level3">
<h3>Advanced R p204 5</h3>
<p>从上述方程中提取R方。</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>R2_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(out1_lapply, rsq)))</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>R2_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(out2_lapply, rsq)))</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>names1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mpg ~ disp&#39;</span>,<span class="st">&#39;mpg ~ I(1 / disp)&#39;</span>,<span class="st">&#39;mpg ~ disp + wt&#39;</span>,<span class="st">&#39;mpg ~ I(1 / disp) + wt&#39;</span>)</span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>names2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a><span class="fu">colnames</span>(R2_1) <span class="ot">&lt;-</span> names1</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="fu">colnames</span>(R2_2) <span class="ot">&lt;-</span> names2</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>R2_1</span></code></pre></div>
<pre><code>##      mpg ~ disp mpg ~ I(1 / disp) mpg ~ disp + wt mpg ~ I(1 / disp) + wt
## [1,]  0.7183433         0.8596865       0.7809306              0.8838038</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>R2_2</span></code></pre></div>
<pre><code>##              1         2         3        4         5         6         7
## [1,] 0.7358689 0.7553011 0.7443189 0.686968 0.7766706 0.7484335 0.7140811
##              8         9        10
## [1,] 0.7522892 0.8628006 0.7288032</code></pre>
</div>
<div id="advanced-r-p213-3" class="section level3">
<h3>Advanced R p213 3</h3>
<p>用sapply和匿名函数提取p值。</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="dv">100</span>,</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a><span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>)</span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="cf">function</span>(result) result<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.721331355 0.178518947 0.579942273 0.618444620 0.041672037 0.010478899
##   [7] 0.170511327 0.253597655 0.950611223 0.326435074 0.638860965 0.050144293
##  [13] 0.331462565 0.434463799 0.812964515 0.745296502 0.522893478 0.121617354
##  [19] 0.877200151 0.878588179 0.593288811 0.784254909 0.922489203 0.838686162
##  [25] 0.523979293 0.021278834 0.791658905 0.646727956 0.244289873 0.088616511
##  [31] 0.158602227 0.525648627 0.302728069 0.577065045 0.910025172 0.501105739
##  [37] 0.568382422 0.557204736 0.673792814 0.793378736 0.758496148 0.477749102
##  [43] 1.000000000 0.089631593 0.656828472 0.165433746 0.736786784 0.928739322
##  [49] 0.481596820 0.117354505 0.160836439 0.005246882 0.051013161 0.496080813
##  [55] 0.032518500 0.194966364 0.167377886 0.424997196 0.003880391 0.032123322
##  [61] 0.106543678 0.843665143 0.808195964 0.151096564 0.761998229 0.930434936
##  [67] 0.980083394 0.227487725 0.870693906 0.364636894 0.369172831 0.172721149
##  [73] 0.916374603 0.421674924 0.210581132 0.856317611 0.879989237 0.435476602
##  [79] 0.936187030 0.135056014 0.841295202 0.867709084 0.362238502 0.227589932
##  [85] 0.964399557 0.503331594 0.682994585 0.247891909 0.084492635 0.936773829
##  [91] 0.982167151 0.861409646 0.280824240 0.373262290 0.949555337 0.425887499
##  [97] 0.316908990 0.070625351 0.658785257 0.473241540</code></pre>
</div>
<div id="advanced-r-p214-6" class="section level3">
<h3>Advanced R p214 6</h3>
<p>用Map()和vapply()来模仿lapply的功能。</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>mv_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(X, f, <span class="at">simplify =</span> F){</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>  <span class="co">#识别f(x)的数据类型，记录为fv</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>  fv <span class="ot">&lt;-</span> <span class="fu">typeof</span>(<span class="fu">f</span>(x[i]))</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>  </span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>  <span class="co">#生成一个长度为1，数据类型为fv的向量作为vapply的参数</span></span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>  f.value <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> fv, <span class="at">length =</span> <span class="dv">1</span>)</span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>  </span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a>  <span class="co">#对x每个元使用vapply</span></span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">Map</span>(<span class="cf">function</span>(x) <span class="fu">vapply</span>(x, f, f.value), X)</span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a>  </span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>  <span class="co">#对是否输出向量类型进行判断</span></span>
<span id="cb105-12"><a href="#cb105-12" tabindex="-1"></a>  <span class="cf">if</span>(simplify <span class="sc">==</span> T){<span class="fu">return</span>(<span class="fu">simplify2array</span>(out))}</span>
<span id="cb105-13"><a href="#cb105-13" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb105-14"><a href="#cb105-14" tabindex="-1"></a>}</span>
<span id="cb105-15"><a href="#cb105-15" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb105-17"><a href="#cb105-17" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">&gt;</span><span class="dv">2</span></span>
<span id="cb105-18"><a href="#cb105-18" tabindex="-1"></a><span class="fu">unlist</span>(<span class="fu">lapply</span>(x, f)) <span class="sc">==</span> <span class="fu">unlist</span>(<span class="fu">mv_lapply</span>(x,f))</span></code></pre></div>
<pre><code>## [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
</div>
<div id="advanced-r-p365-4" class="section level3">
<h3>Advanced R p365 4</h3>
<p>写一个比chiq.test()函数更快的进行卡方检验的函数。</p>
<p><span class="math display">\[\chi^2=n(\sum_{i=1}^{r}\sum_{j=1}^{c}\frac{n_{ij}^2}{n_{i.}n_{.j}}-1)\]</span></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co">#两样本卡方独立性检验</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>fastchisqtest <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x)<span class="sc">!=</span><span class="fu">length</span>(y)) {<span class="fu">stop</span>(<span class="st">&quot;x与y长度不一致，请检查后输入。&quot;</span>)}</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(tab)</span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>  ni_ <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tab)</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>  n_j <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tab)</span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>  div <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(ni_,n_j)</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>  chisqe <span class="ot">&lt;-</span> n<span class="sc">*</span>(<span class="fu">sum</span>(tab<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>div)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(n_j)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>  pvalue <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(chisqe, <span class="at">df =</span> d, <span class="at">lower.tail =</span> F)</span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">chi_stat =</span> chisqe, <span class="at">df =</span> d, <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> pvalue))</span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来检验该方法是否与<code>chisq.test</code>一致，结果可以看出每个值都一样。</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">replace =</span> T); y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">replace =</span> T)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="fu">fastchisqtest</span>(x,y)</span></code></pre></div>
<pre><code>## $chi_stat
## [1] 11.04409
## 
## $df
## [1] 9
## 
## $`p-value`
## [1] 0.2726992</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">cbind</span>(x,y))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  cbind(x, y)
## X-squared = 11.044, df = 9, p-value = 0.2727</code></pre>
<p>接下里用两种方法检验该函数和<code>chisq.test</code>的差距，第一种是使用直接计算时间差，该方法有一定随机性，两种方法的用时可能会交替更短。</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>time_fast_0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">fastchisqtest</span>(x,y))</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>time_fast_1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>time_fast <span class="ot">&lt;-</span> time_fast_1<span class="sc">-</span>time_fast_0</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>time_chi_0 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">chisq.test</span>(<span class="fu">cbind</span>(x,y)))</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>time_chi_1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>time_chi <span class="ot">&lt;-</span> time_chi_1<span class="sc">-</span>time_chi_0</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="st">&#39;time of fast&#39;</span> <span class="ot">=</span> time_fast, <span class="st">&#39;time of chisq.test&#39;</span> <span class="ot">=</span> time_chi),<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## Time differences in secs
##       time of fast time of chisq.test 
##         0.00104213         0.00101304</code></pre>
<p>另一种方法是使用microbenchmark包中的<code>microbenchmark</code>函数，计算两种方法的平均耗时，此方法下，<code>fastchisqtest()</code>表现更好。</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>  <span class="fu">fastchisqtest</span>(x,y),</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>  <span class="fu">chisq.test</span>(<span class="fu">cbind</span>(x,y))</span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Unit: microseconds
##                     expr  min   lq    mean median     uq   max neval
##      fastchisqtest(x, y)  7.5  8.3  11.335   9.10  10.75  53.5   100
##  chisq.test(cbind(x, y)) 73.4 80.8 108.680  87.95 115.50 311.5   100</code></pre>
</div>
<div id="advanced-r-p365-5" class="section level3">
<h3>Advanced R p365 5</h3>
<p>写一个更快版本的table。</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>fasttable <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>  xtitle <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x))</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>  ytitle <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(y))</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>  lx <span class="ot">&lt;-</span> <span class="fu">length</span>(xtitle)</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>  ly <span class="ot">&lt;-</span> <span class="fu">length</span>(ytitle)</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>  dim <span class="ot">&lt;-</span> <span class="fu">c</span>(lx, ly)</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> lx <span class="sc">*</span> ly</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>  dimnames <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> xtitle, <span class="at">y =</span> ytitle)</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>  bin <span class="ot">&lt;-</span> fastmatch<span class="sc">::</span><span class="fu">fmatch</span>(x, xtitle) <span class="sc">+</span>lx <span class="sc">*</span> fastmatch<span class="sc">::</span><span class="fu">fmatch</span>(y, ytitle) <span class="sc">-</span> lx</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(bin, pr)</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a>   tab<span class="ot">&lt;-</span> <span class="fu">array</span>(tab, <span class="at">dim =</span> dim, <span class="at">dimnames =</span> dimnames)</span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a>  <span class="fu">class</span>(tab) <span class="ot">&lt;-</span> <span class="st">&quot;table&quot;</span></span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a>  tab</span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">replace =</span> T); y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">replace =</span> T)</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="fu">table</span>(x,y)</span></code></pre></div>
<pre><code>##     y
## x    1 2 5 8 10
##   1  0 0 0 0  1
##   2  0 1 0 0  0
##   3  0 0 0 1  0
##   5  0 1 0 0  0
##   6  1 0 0 0  0
##   9  0 0 0 3  0
##   10 0 1 1 0  0</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">fasttable</span>(x,y)</span></code></pre></div>
<pre><code>##     y
## x    1 2 5 8 10
##   1  0 0 0 0  1
##   2  0 1 0 0  0
##   3  0 0 0 1  0
##   5  0 1 0 0  0
##   6  1 0 0 0  0
##   9  0 0 0 3  0
##   10 0 1 1 0  0</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>  <span class="fu">table</span>(x, y),</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>  <span class="fu">fasttable</span>(x, y)</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Unit: microseconds
##             expr  min    lq   mean median    uq   max neval
##      table(x, y) 62.8 66.95 70.850   69.1 70.75 203.6   100
##  fasttable(x, y) 43.0 46.30 48.778   48.2 50.00  93.9   100</code></pre>
</div>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
<div id="exercise-4" class="section level3">
<h3>exercise</h3>
<p>用Rcpp写一个9.8题中Gibbs样本生成器的更快的版本。</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gibbsC(int k, int thin, double a, double b, int n) {</span></span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="st">    NumericMatrix mat(k, 2);</span></span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a><span class="st">    int x = 0;</span></span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a><span class="st">    double y = 0.5;</span></span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a><span class="st">    for (int i = 0; i &lt; k; i++) {</span></span>
<span id="cb123-7"><a href="#cb123-7" tabindex="-1"></a><span class="st">        for (int j = 0; j &lt; thin; j++) {</span></span>
<span id="cb123-8"><a href="#cb123-8" tabindex="-1"></a><span class="st">            x = rbinom(1, n, y)[0];</span></span>
<span id="cb123-9"><a href="#cb123-9" tabindex="-1"></a><span class="st">            y = rbeta(1, (x + a), (n - x + b))[0];</span></span>
<span id="cb123-10"><a href="#cb123-10" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb123-11"><a href="#cb123-11" tabindex="-1"></a><span class="st">        mat(i, 0) = x;</span></span>
<span id="cb123-12"><a href="#cb123-12" tabindex="-1"></a><span class="st">        mat(i, 1) = y;</span></span>
<span id="cb123-13"><a href="#cb123-13" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb123-14"><a href="#cb123-14" tabindex="-1"></a><span class="st">    return(mat);</span></span>
<span id="cb123-15"><a href="#cb123-15" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(k,thin, a, b, n) {</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">nrow=</span>k)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb124-7"><a href="#cb124-7" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb124-8"><a href="#cb124-8" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, (x <span class="sc">+</span> a), (n <span class="sc">-</span> x <span class="sc">+</span> b))</span>
<span id="cb124-9"><a href="#cb124-9" tabindex="-1"></a>    }</span>
<span id="cb124-10"><a href="#cb124-10" tabindex="-1"></a>    mat[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb124-11"><a href="#cb124-11" tabindex="-1"></a>  }</span>
<span id="cb124-12"><a href="#cb124-12" tabindex="-1"></a>  mat</span>
<span id="cb124-13"><a href="#cb124-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span>; thin <span class="ot">&lt;-</span> <span class="dv">10</span>; a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span>; n <span class="ot">&lt;-</span> <span class="dv">2</span>  </span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>gibbs_sample_R <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(k,thin, a, b, n)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>gibbs_sample_C <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(k, thin, a, b, n)</span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a><span class="fu">qqplot</span>(gibbs_sample_R, gibbs_sample_C)</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>用<code>microbenchmark</code>比较两个函数的速度。</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(gibbs_sample_R <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(k,thin, a, b, n),</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>               gibbs_sample_C <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(k, thin, a, b, n))</span></code></pre></div>
<pre><code>## Unit: microseconds
##                                        expr      min       lq      mean
##  gibbs_sample_R &lt;- gibbsR(k, thin, a, b, n) 1213.501 1317.200 1449.7200
##  gibbs_sample_C &lt;- gibbsC(k, thin, a, b, n)  239.901  262.401  285.1821
##    median       uq      max neval
##  1363.052 1427.451 3067.001   100
##   271.551  284.051 1110.501   100</code></pre>
<p>从QQ图中可以看出，用R和Rcpp分别使用Gibbs样本生成器生成9.8题中的两样本随机变量x,y的各分位数近似位于y=x直线上，说明这两个生成器具有同样的效果，但使用microbenchmark测试后发现，Rcpp的计算效率比R要高许多，前者所花时间仅仅是后者的1/5不到。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
